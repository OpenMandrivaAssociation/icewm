---
 src/Makefile       |    2 	1 +	1 -	0 !
 src/aworkspaces.cc |   12 	10 +	2 -	0 !
 src/base.h         |    1 	1 +	0 -	0 !
 src/wmapp.cc       |    1 	1 +	0 -	0 !
 src/wmbutton.cc    |   11 	9 +	2 -	0 !
 src/wmclient.cc    |    2 	2 +	0 -	0 !
 src/wmtaskbar.cc   |    5 	4 +	1 -	0 !
 src/ybutton.cc     |    5 	4 +	1 -	0 !
 src/ymenu.cc       |    4 	4 +	0 -	0 !
 src/ymenuitem.cc   |    6 	6 +	0 -	0 !
 10 files changed, 42 insertions(+), 7 deletions(-)

Index: icewm-1.3.1/src/base.h
===================================================================
--- icewm-1.3.1.orig/src/base.h	2007-08-07 01:19:19.000000000 -0400
+++ icewm-1.3.1/src/base.h	2009-08-17 05:18:47.000000000 -0400
@@ -48,6 +48,7 @@ char *newstr(char const *str);
 char *newstr(char const *str, int len);
 char *newstr(char const *str, char const *delim);
 char *cstrJoin(char const *str, ...);
+#define strJoin cstrJoin
 #endif
 
 #if 0
Index: icewm-1.3.1/src/wmclient.cc
===================================================================
--- icewm-1.3.1.orig/src/wmclient.cc	2007-08-07 01:19:19.000000000 -0400
+++ icewm-1.3.1/src/wmclient.cc	2009-08-17 05:18:47.000000000 -0400
@@ -492,7 +492,9 @@ void YFrameClient::handleProperty(const 
             msg("change: net wm icon");
             if (new_prop) prop.net_wm_icon = true;
             if (getFrame())
+#ifndef LITE
                 getFrame()->updateIcon();
+#endif
             prop.net_wm_icon = new_prop;
 #endif
 #ifdef GNOME1_HINTS
Index: icewm-1.3.1/src/wmtaskbar.cc
===================================================================
--- icewm-1.3.1.orig/src/wmtaskbar.cc	2007-08-07 01:19:19.000000000 -0400
+++ icewm-1.3.1/src/wmtaskbar.cc	2009-08-17 05:18:47.000000000 -0400
@@ -1112,7 +1112,7 @@ void TaskBar::relayoutTasks() {
     if (taskPane())
         taskPane()->relayout();
 }
-
+#ifdef CONFIG_TRAY
 void TaskBar::removeTrayApp(YFrameWindow *w) {
     if (windowTrayPane())
         windowTrayPane()->removeApp(w);
@@ -1129,12 +1129,15 @@ void TaskBar::relayoutTray() {
     if (windowTrayPane())
         windowTrayPane()->relayout();
 }
+#endif
 
+#ifdef CONFIG_ADDRESSBAR
 void TaskBar::showAddressBar() {
     popOut();
     if (fAddressBar != 0)
         fAddressBar->showNow();
 }
+#endif
 
 void TaskBar::setWorkspaceActive(long workspace, int active) {
     if (fWorkspaces != 0 &&
Index: icewm-1.3.1/src/wmapp.cc
===================================================================
--- icewm-1.3.1.orig/src/wmapp.cc	2007-08-07 01:19:19.000000000 -0400
+++ icewm-1.3.1/src/wmapp.cc	2009-08-17 05:18:47.000000000 -0400
@@ -38,6 +38,7 @@
 #include "yrect.h"
 #include "yprefs.h"
 #include "yicon.h"
+#include "ylistbox.h"
 #include "prefs.h"
 #include "upath.h"
 
Index: icewm-1.3.1/src/Makefile
===================================================================
--- icewm-1.3.1.orig/src/Makefile	2007-08-07 01:19:39.000000000 -0400
+++ icewm-1.3.1/src/Makefile	2009-08-17 05:18:47.000000000 -0400
@@ -212,7 +212,7 @@ clean:
 
 $(BINARIES):
 	@echo "  LD    " $@
-	@$(LD) -o $@$(EXEEXT) $($@_OBJS) $(LFLAGS) $($@_LFLAGS) $(LIBS) $($@_LIBS)
+	$(LD) -o $@$(EXEEXT) $($@_OBJS) $(LFLAGS) $($@_LFLAGS) $(LIBS) $($@_LIBS)
 
 genpref.o: genpref.cc
 	@echo "  HOSTCXX   " $@
Index: icewm-1.3.1/src/wmbutton.cc
===================================================================
--- icewm-1.3.1.orig/src/wmbutton.cc	2007-08-07 01:19:19.000000000 -0400
+++ icewm-1.3.1/src/wmbutton.cc	2009-08-17 05:18:47.000000000 -0400
@@ -148,10 +148,10 @@ void YFrameButton::paint(Graphics &g, co
         }
     }
 
-    int iconSize = YIcon::smallSize();
 #ifdef LITE
     ref<YIcon> icon;
 #else
+    int iconSize = YIcon::smallSize();
     ref<YIcon> icon =
         (fAction == 0) ? getFrame()->clientIcon() : null;
 #endif
@@ -170,11 +170,13 @@ void YFrameButton::paint(Graphics &g, co
 
             g.fillRect(1, 1, width() - 2, height() - 2);
 
+#ifndef LITE
             if (icon != null && showFrameIcon)
                 icon->draw(g,
                            (width() - iconSize) / 2,
                            (height() - iconSize) / 2,
                            iconSize);
+#endif
         } else {
             g.fillRect(0, 0, width(), height());
 
@@ -221,11 +223,13 @@ void YFrameButton::paint(Graphics &g, co
         if (fAction == 0) {
             g.fillRect(xPos, yPos, w, h);
 
+#ifndef LITE
             if (icon != null && showFrameIcon)
                 icon->draw(g,
                            xPos + (w - iconSize) / 2,
                            yPos + (h - iconSize) / 2,
                            iconSize);
+#endif
         } else {
             if (pixmap != null)
                 g.drawCenteredPixmap(xPos, yPos, w, h, pixmap);
@@ -246,11 +250,13 @@ CASE_LOOK_WIN95:
 
             g.fillRect(0, 0, width(), height());
 
+#ifndef LITE
             if (icon != null && showFrameIcon)
                 icon->draw(g,
                            (width() - iconSize) / 2,
                            (height() - iconSize) / 2,
                            iconSize);
+#endif
         } else {
             g.drawBorderW(0, 0, width() - 1, height() - 1, !armed);
 
@@ -286,12 +292,13 @@ CASE_LOOK_WIN95:
         } else
             g.fillRect(0, 0, width(), height());
 
+#ifndef LITE
         if (fAction == 0 && icon != null && showFrameIcon)
             icon->draw(g,
                        ((int)width() - (int)iconSize) / 2,
                        ((int)height() - (int)iconSize) / 2,
                        iconSize);
-
+#endif
         break;
 #endif
     default:
Index: icewm-1.3.1/src/ymenu.cc
===================================================================
--- icewm-1.3.1.orig/src/ymenu.cc	2007-08-07 01:19:19.000000000 -0400
+++ icewm-1.3.1/src/ymenu.cc	2009-08-17 05:18:47.000000000 -0400
@@ -151,9 +151,11 @@ int YMenu::onCascadeButton(int selItem, 
         int fontHeight = menuFont->height() + 1;
         int h = fontHeight;
 
+#ifndef LITE
         if (getItem(selItem)->getIcon() != null &&
             YIcon::smallSize() > h)
             h = YIcon::smallSize();
+#endif
 
         if (x <= int(width() - h - 4))
             return 1;
@@ -1015,12 +1017,14 @@ void YMenu::paintItem(Graphics &g, const
                     points[3].y = 5;
 
                     g.fillPolygon(points, 4, Convex, CoordModePrevious);
+#ifndef LITE
                 } else if (mitem->getIcon() != null) {
                     mitem->getIcon()->draw(g,
                                l + 1 + delta, t + delta + top + pad +
                                (eh - top - pad * 2 - bottom -
                                 YIcon::smallSize()) / 2,
                                YIcon::smallSize());
+#endif
                 }
 
                 if (name != null) {
Index: icewm-1.3.1/src/ymenuitem.cc
===================================================================
--- icewm-1.3.1.orig/src/ymenuitem.cc	2007-08-07 01:19:19.000000000 -0400
+++ icewm-1.3.1/src/ymenuitem.cc	2009-08-17 05:18:47.000000000 -0400
@@ -85,8 +85,10 @@ int YMenuItem::queryHeight(int &top, int
         int fontHeight = max(16, menuFont->height() + 1);
         int ih = fontHeight;
 
+#ifndef LITE
         if (YIcon::smallSize() > ih)
             ih = YIcon::smallSize();
+#endif
 
         if (wmLook == lookWarp4 || wmLook == lookWin95) {
             top = bottom = 0;
@@ -118,7 +120,11 @@ int YMenuItem::queryHeight(int &top, int
 
 int YMenuItem::getIconWidth() const {
     ref<YIcon> icon = getIcon();
+#ifndef LITE
     return icon != null ? YIcon::smallSize(): 0;
+#else
+    return 0;
+#endif
 }
 
 int YMenuItem::getNameWidth() const {
Index: icewm-1.3.1/src/ybutton.cc
===================================================================
--- icewm-1.3.1.orig/src/ybutton.cc	2007-08-07 01:19:19.000000000 -0400
+++ icewm-1.3.1/src/ybutton.cc	2009-08-17 05:18:47.000000000 -0400
@@ -80,12 +80,15 @@ void YButton::paint(Graphics &g, int con
     YSurface surface(getSurface());
     g.drawSurface(surface, x, y, w, h);
 
+#ifndef LITE
     if (fIcon != null)
         fIcon->draw(g,
                     x + (w - fIconSize) / 2,
                     y + (h - fIconSize) / 2,
                     fIconSize);
-    else if (fImage != null)
+    else
+#endif
+    if (fImage != null)
         g.drawImage(fImage,
                     x + (w - fImage->width()) / 2,
                     y + (h - fImage->height()) / 2);
Index: icewm-1.3.1/src/aworkspaces.cc
===================================================================
--- icewm-1.3.1.orig/src/aworkspaces.cc	2007-08-07 01:19:19.000000000 -0400
+++ icewm-1.3.1/src/aworkspaces.cc	2009-08-17 05:18:47.000000000 -0400
@@ -249,19 +249,26 @@ YSurface WorkspaceButton::getSurface() {
 }
 
 void WorkspacesPane::repaint() {
+#ifdef LITE
+    return;
+#else
     if (!pagerShowPreview) return;
 
     for (int w = 0; w < workspaceCount; w++) {
         fWorkspaceButton[w]->repaint();
     }
+#endif
 }
 
 void WorkspaceButton::paint(Graphics &g, const YRect &/*r*/) {
-    if (!pagerShowPreview) {
+#ifdef LITE
+    if (!pagerShowPreview)
+#endif
+    {
         YButton::paint(g, YRect(0,0,0,0));
         return;
     }
-
+#ifndef LITE
     int x(0), y(0), w(width()), h(height());
 
     if (w > 1 && h > 1) {
@@ -351,6 +358,7 @@ void WorkspaceButton::paint(Graphics &g,
             g.drawChars(label, 0, strlen(label), wx, wy);
         }
     }
+#endif
 }
 
 #endif
